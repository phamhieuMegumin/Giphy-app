(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{38:function(e,t,n){},51:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(1),c=n.n(a),s=n(18),i=n.n(s),o=n(9),u=n(10),j=n.n(u),l=n(16),b={login:function(){var e=Object(l.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/user/login",{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});case 2:if(401===(n=e.sent).status){e.next=9;break}return e.next=6,n.json();case 6:return e.abrupt("return",e.sent);case 9:return r={isAuthenticated:!1,user:{username:"",role:""}},e.abrupt("return",r);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(l.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/user/register",{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),logout:function(){var e=Object(l.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/user/logout");case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),isAuthenticated:function(){var e=Object(l.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("user/authenticated",{mode:"no-cors"});case 2:if(401===(t=e.sent).status){e.next=10;break}return console.log(t.status),e.next=7,t.json();case 7:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",{isAuthenticated:!1,user:{username:"",role:""}});case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},d=Object(a.createContext)(),O=function(e){var t=e.children,n=Object(a.useState)(null),c=Object(o.a)(n,2),s=c[0],i=c[1],u=Object(a.useState)(!1),j=Object(o.a)(u,2),l=j[0],O=j[1],h=Object(a.useState)(!1),x=Object(o.a)(h,2),p=x[0],f=x[1];return Object(a.useEffect)((function(){b.isAuthenticated().then((function(e){i(e.user),O(e.isAuthenticated),f(!0)}))}),[]),Object(r.jsx)("div",{children:p?Object(r.jsx)(d.Provider,{value:{user:s,setUser:i,isAuthenticated:l,setIsAuthenticated:O},children:t}):Object(r.jsx)("h1",{children:"Loading"})})},h=n(11),x=(n(38),n(58)),p=n(59),f=n(60),m=n(61),v=n(62),g=n(68),w=n(63);var y=function(){var e=Object(a.useContext)(d),t=e.user,n=e.setUser,c=e.isAuthenticated,s=e.setIsAuthenticated,i=Object(a.useState)(!1),u=Object(o.a)(i,2),j=u[0],l=u[1],O=function(){b.logout().then((function(e){e.success&&(n(e.user),s(!1))}))};return Object(r.jsx)("div",{children:Object(r.jsxs)(f.a,{color:"light",light:!0,expand:"md",children:[Object(r.jsx)(h.b,{to:"/",children:Object(r.jsx)(m.a,{children:"Logo"})}),Object(r.jsx)(v.a,{onClick:function(){return l(!j)}}),Object(r.jsx)(g.a,{isOpen:j,navbar:!0,children:Object(r.jsx)(w.a,{className:"mr-auto",navbar:!0,children:c?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(x.a,{children:Object(r.jsx)(h.b,{to:"/",children:"Home"})}),Object(r.jsx)(x.a,{children:Object(r.jsx)(h.b,{to:"/favorites",children:"Favorites"})}),"admin"===t.role?Object(r.jsx)(x.a,{children:Object(r.jsx)(h.b,{to:"/admin",children:"Admin"})}):null,Object(r.jsx)(p.a,{onClick:O,children:"Logout"})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(x.a,{children:Object(r.jsx)(h.b,{to:"/",children:"Home"})}),Object(r.jsx)(x.a,{children:Object(r.jsx)(h.b,{to:"/login",children:"Login"})}),Object(r.jsx)(x.a,{children:Object(r.jsx)(h.b,{to:"/register",children:"Register"})})]})})})]})})},A=n(7);n(51);var k=function(e){var t=e.data,n=e.handleOnClick;return Object(r.jsxs)("div",{className:"item-container",children:[Object(r.jsx)("div",{className:"img-box",children:Object(r.jsx)("img",{src:t})}),Object(r.jsx)("div",{className:"btn-add",children:Object(r.jsx)(p.a,{onClick:function(){n(t)},children:"Add to favorite"})})]})},C={getFavorite:function(){var e=Object(l.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/user/favorites");case 2:if(401===(t=e.sent).status){e.next=9;break}return e.next=6,t.json();case 6:return e.abrupt("return",e.sent);case 9:return e.abrupt("return",{message:{msgBody:"UnAuthorized",msgError:!0}});case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),postFavorite:function(){var e=Object(l.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/user/favorite",{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}});case 2:if(401===(n=e.sent).status){e.next=9;break}return e.next=6,n.json();case 6:return e.abrupt("return",e.sent);case 9:return e.abrupt("return",{message:{msgBody:"UnAuthorized",msgError:!0}});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};var S=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(1),i=Object(o.a)(s,2);i[0],i[1],Object(a.useEffect)((function(){(function(){var e=Object(l.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://api.giphy.com/v1/gifs/trending?api_key=JjiRVm3bXZXAkfwAccSJB7bGELIXtT11&limit=".concat(15));case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,c(n.data);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var u=Object(a.useContext)(d),b=Object(a.useState)(null),O=Object(o.a)(b,2),h=(O[0],O[1]),x=function(e){var t={url:e};C.postFavorite(t).then((function(e){var t=e.message;t.msgError?"UnAuthorzied"===t.msgBody?(h(t),u.setUser({username:"",role:""}),u.setIsAuthenticated(!1)):h(t):C.getFavorite().then((function(e){h(t)}))}))};return Object(r.jsx)("div",{className:"container",children:Object(r.jsx)("div",{className:"ListItems",children:n.map((function(e){return Object(r.jsx)(k,{data:e.images.original.url,handleOnClick:x},e.id)}))})})};n(52);var N=function(){return Object(r.jsxs)("div",{className:"home-page",children:[Object(r.jsx)("h1",{children:"Top Trending Giphy"}),Object(r.jsx)(S,{})]})},E=n(17),U=n(12),F=n(64),P=n(65),R=n(66),T=n(67);var I=function(e){return Object(r.jsx)("div",{className:function(e){var t="alert ";return e.message.msgError?t+="alert-danger":t+="alert-primary",t}(e),role:"alert",children:e.message.msgBody})};n(53);var J=function(){var e=Object(a.useState)({username:"",password:""}),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(null),i=Object(o.a)(s,2),u=i[0],j=i[1],l=function(e){c(Object(U.a)(Object(U.a)({},n),{},Object(E.a)({},e.target.name,e.target.value)))},O=Object(a.useContext)(d),h=Object(A.f)(),x={username:"phamquanghieu8820",password:"123456"};return Object(r.jsx)("div",{className:"login-container",children:Object(r.jsxs)(F.a,{onSubmit:function(e){e.preventDefault(),b.login(x).then((function(e){var t=e.isAuthenticated,n=e.user,r=e.message;t?(O.setUser(n),O.setIsAuthenticated(t),h.push("/")):j(r)}))},children:[Object(r.jsxs)(P.a,{children:[Object(r.jsx)(R.a,{for:"exampleEmail",children:"Username"}),Object(r.jsx)(T.a,{type:"text",name:"username",id:"exampleEmail",placeholder:"username",onChange:l})]}),Object(r.jsxs)(P.a,{children:[Object(r.jsx)(R.a,{for:"examplePassword",children:"Password"}),Object(r.jsx)(T.a,{type:"password",name:"password",id:"examplePassword",placeholder:"password",onChange:l})]}),Object(r.jsx)(p.a,{children:"Login"}),u?Object(r.jsx)(I,{message:u}):null]})})};n(54);var L=function(){var e=Object(a.useState)({username:"",password:"",role:""}),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(null),i=Object(o.a)(s,2),u=i[0],j=i[1],l=Object(a.useRef)(null),d=Object(A.f)();Object(a.useEffect)((function(){return function(){clearTimeout(l)}}),[]);var O=function(e){c(Object(U.a)(Object(U.a)({},n),{},Object(E.a)({},e.target.name,e.target.value)))};return Object(r.jsx)("div",{className:"register-container",children:Object(r.jsxs)(F.a,{onSubmit:function(e){e.preventDefault(),b.register(n).then((function(e){var t=e.message;j(t),c({username:"",password:"",role:""}),t.msgError||(l=setTimeout((function(){d.push("/login")}),2e3))}))},children:[Object(r.jsxs)(P.a,{children:[Object(r.jsx)(R.a,{for:"exampleEmail",children:"User"}),Object(r.jsx)(T.a,{type:"text",name:"username",id:"exampleEmail",value:n.username,placeholder:"username",onChange:O})]}),Object(r.jsxs)(P.a,{children:[Object(r.jsx)(R.a,{for:"examplePassword",children:"Password"}),Object(r.jsx)(T.a,{type:"password",name:"password",id:"examplePassword",value:n.password,placeholder:"password",onChange:O})]}),Object(r.jsxs)(P.a,{children:[Object(r.jsx)(R.a,{for:"exampleRole",children:"Role"}),Object(r.jsx)(T.a,{type:"text",name:"role",id:"exampleRole",value:n.role,placeholder:"Role (admin/user)",onChange:O})]}),Object(r.jsx)(p.a,{children:"Register"}),u?Object(r.jsx)(I,{message:u}):null]})})};var B=function(e){var t=e.listfavorite.url;return Object(r.jsx)("div",{className:"item-container",children:Object(r.jsx)("div",{className:"img-box",children:Object(r.jsx)("img",{src:t})})})};n(55);var z=function(){var e=Object(a.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){C.getFavorite().then((function(e){c(e.favorites)}))}),[]),Object(r.jsx)("div",{className:"favorite-container",children:n.map((function(e){return Object(r.jsx)(B,{listfavorite:e},e._id)}))})};var X=function(){return Object(r.jsx)("div",{children:Object(r.jsx)("h1",{children:"Admin Page"})})},D=n(19);var G=function(e){var t=e.component,n=e.roles,c=Object(D.a)(e,["component","roles"]),s=Object(a.useContext)(d),i=s.isAuthenticated,o=s.user;return Object(r.jsx)(A.b,Object(U.a)(Object(U.a)({},c),{},{render:function(e){return i?n.includes(o.role)?Object(r.jsx)(t,Object(U.a)({},e)):Object(r.jsx)(A.a,{to:{pathname:"/",state:{from:e.location}}}):Object(r.jsx)(A.a,{to:{pathname:"/login",state:{from:e.location}}})}}))};var H=function(e){var t=e.component,n=Object(D.a)(e,["component"]),c=Object(a.useContext)(d).isAuthenticated;return Object(r.jsx)(A.b,Object(U.a)(Object(U.a)({},n),{},{render:function(e){return c?Object(r.jsx)(A.a,{to:{pathname:"/",state:{from:e.location}}}):Object(r.jsx)(t,Object(U.a)({},e))}}))};var _=function(){return Object(r.jsxs)(h.a,{children:[Object(r.jsx)(y,{}),Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)(A.b,{exact:!0,path:"/",component:N}),Object(r.jsx)(A.b,{path:"/login",component:J}),Object(r.jsx)(H,{path:"/register",component:L}),Object(r.jsx)(G,{path:"/favorites",roles:["user","admin"],component:z}),Object(r.jsx)(G,{path:"/admin",roles:["admin"],component:X})]})]})};n(56);i.a.render(Object(r.jsx)(O,{children:Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(_,{})})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.fcb46b22.chunk.js.map